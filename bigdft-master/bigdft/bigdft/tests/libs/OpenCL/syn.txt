subroutine synthesis_free(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: se1
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      se1 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free
subroutine synthesis_free_u1(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: se1
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 0
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      se1 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u1
subroutine synthesis_free_u2(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: se1
  real(kind=8) :: se2
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 1, 2
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 2) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u2
subroutine synthesis_free_u3(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 2, 3
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 3) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u3
subroutine synthesis_free_u4(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 3, 4
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 4) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u4
subroutine synthesis_free_u5(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 4, 5
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 5) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u5
subroutine synthesis_free_u6(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 5, 6
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 6) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u6
subroutine synthesis_free_u7(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: so7
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
  real(kind=8) :: se7
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 6, 7
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
        se7 = se7 + (fil((l) * (2))) * (x(k, j + 6)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 6))
        so7 = so7 + (fil((l) * (2) + 1)) * (x(k, j + 6)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 6))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
        se7 = se7 + (fil((l) * (2))) * (x(k, j + 6)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 6))
        so7 = so7 + (fil((l) * (2) + 1)) * (x(k, j + 6)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 6))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 7) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u7
subroutine synthesis_free_u8(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, -3 - 4:(n) * (2) - 1 - -3 + 4) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: so7
  real(kind=8) :: so8
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
  real(kind=8) :: se7
  real(kind=8) :: se8
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 7, 8
    do i=-3 - 1,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
        se7 = se7 + (fil((l) * (2))) * (x(k, j + 6)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 6))
        so7 = so7 + (fil((l) * (2) + 1)) * (x(k, j + 6)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 6))
        se8 = se8 + (fil((l) * (2))) * (x(k, j + 7)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 7))
        so8 = so8 + (fil((l) * (2) + 1)) * (x(k, j + 7)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 7))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-3) * (2))) * (x(k, j + 7)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-3) * (2) + 1)) * (x(k, j + 7)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-2) * (2))) * (x(k, j + 7)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-2) * (2) + 1)) * (x(k, j + 7)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-1) * (2))) * (x(k, j + 7)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-1) * (2) + 1)) * (x(k, j + 7)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((0) * (2))) * (x(k, j + 7)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((0) * (2) + 1)) * (x(k, j + 7)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((1) * (2))) * (x(k, j + 7)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((1) * (2) + 1)) * (x(k, j + 7)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((2) * (2))) * (x(k, j + 7)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((2) * (2) + 1)) * (x(k, j + 7)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((3) * (2))) * (x(k, j + 7)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((3) * (2) + 1)) * (x(k, j + 7)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((4) * (2))) * (x(k, j + 7)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((4) * (2) + 1)) * (x(k, j + 7)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 7))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
    do i=n - 4, n - 2 + 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
        se2 = se2 + (fil((l) * (2))) * (x(k, j + 1)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 1))
        so2 = so2 + (fil((l) * (2) + 1)) * (x(k, j + 1)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 1))
        se3 = se3 + (fil((l) * (2))) * (x(k, j + 2)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 2))
        so3 = so3 + (fil((l) * (2) + 1)) * (x(k, j + 2)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 2))
        se4 = se4 + (fil((l) * (2))) * (x(k, j + 3)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 3))
        so4 = so4 + (fil((l) * (2) + 1)) * (x(k, j + 3)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 3))
        se5 = se5 + (fil((l) * (2))) * (x(k, j + 4)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 4))
        so5 = so5 + (fil((l) * (2) + 1)) * (x(k, j + 4)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 4))
        se6 = se6 + (fil((l) * (2))) * (x(k, j + 5)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 5))
        so6 = so6 + (fil((l) * (2) + 1)) * (x(k, j + 5)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 5))
        se7 = se7 + (fil((l) * (2))) * (x(k, j + 6)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 6))
        so7 = so7 + (fil((l) * (2) + 1)) * (x(k, j + 6)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 6))
        se8 = se8 + (fil((l) * (2))) * (x(k, j + 7)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 7))
        so8 = so8 + (fil((l) * (2) + 1)) * (x(k, j + 7)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 7))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 8) + 1, ndat
    do i=-3 - 1, n - 2 + 4
      so1 = 0.0
      se1 = 0.0
      do l=max( - i, -3), min(4, n - 1 - i)
        k = i + l
        se1 = se1 + (fil((l) * (2))) * (x(k, j + 0)) + (fil((l) * (-2) + 3)) * (x(n + k, j + 0))
        so1 = so1 + (fil((l) * (2) + 1)) * (x(k, j + 0)) - (fil((l) * (-2) + 2)) * (x(n + k, j + 0))
      enddo
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_free_u8
subroutine synthesis_per(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: se1
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0,  - -3 - 1
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      se1 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per
subroutine synthesis_per_u1(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: se1
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 0
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0,  - -3 - 1
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      se1 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u1
subroutine synthesis_per_u2(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: se1
  real(kind=8) :: se2
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 1, 2
    so1 = 0.0
    so2 = 0.0
    se1 = 0.0
    se2 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      se1 = 0.0
      se2 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 2) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u2
subroutine synthesis_per_u3(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 2, 3
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 3) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u3
subroutine synthesis_per_u4(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 3, 4
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    so4 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    se4 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 3, (n) * (2) - 1) = so4
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    y(j + 3, 0) = se4
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 4) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u4
subroutine synthesis_per_u5(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 4, 5
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    so4 = 0.0
    so5 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    se4 = 0.0
    se5 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 3, (n) * (2) - 1) = so4
    y(j + 4, (n) * (2) - 1) = so5
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    y(j + 3, 0) = se4
    y(j + 4, 0) = se5
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 5) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u5
subroutine synthesis_per_u6(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 5, 6
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    so4 = 0.0
    so5 = 0.0
    so6 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    se4 = 0.0
    se5 = 0.0
    se6 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 3, (n) * (2) - 1) = so4
    y(j + 4, (n) * (2) - 1) = so5
    y(j + 5, (n) * (2) - 1) = so6
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    y(j + 3, 0) = se4
    y(j + 4, 0) = se5
    y(j + 5, 0) = se6
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 6) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u6
subroutine synthesis_per_u7(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: so7
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
  real(kind=8) :: se7
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 6, 7
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    so4 = 0.0
    so5 = 0.0
    so6 = 0.0
    so7 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    se4 = 0.0
    se5 = 0.0
    se6 = 0.0
    se7 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 3, (n) * (2) - 1) = so4
    y(j + 4, (n) * (2) - 1) = so5
    y(j + 5, (n) * (2) - 1) = so6
    y(j + 6, (n) * (2) - 1) = so7
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    y(j + 3, 0) = se4
    y(j + 4, 0) = se5
    y(j + 5, 0) = se6
    y(j + 6, 0) = se7
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 7) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u7
subroutine synthesis_per_u8(n, ndat, x, y)
  integer(kind=4), parameter :: lowfil = -3
  integer(kind=4), parameter :: upfil = 4
  integer(kind=4), intent(in) :: n
  integer(kind=4), intent(in) :: ndat
  real(kind=8), intent(in), dimension(0:(n) * (2) - 1, 1:ndat + 1 - 1) :: x
  real(kind=8), intent(out), dimension(1:ndat + 1 - 1, 0:(n) * (2) - 1) :: y
  integer(kind=4) :: i
  integer(kind=4) :: j
  integer(kind=4) :: k
  integer(kind=4) :: l
  real(kind=8), parameter, dimension(-6:9) :: fil = (/ &
0.0018899503327676891843d0, &
-0.00030292051472413308126d0, &
-0.014952258337062199118d0, &
0.0038087520138944894631d0, &
0.049137179673730286787d0, &
-0.027219029917103486322d0, &
-0.051945838107881800736d0, &
0.36444189483617893676d0, &
0.77718575169962802862d0, &
0.48135965125905339159d0, &
-0.061273359067811077843d0, &
-0.14329423835127266284d0, &
0.0076074873249766081919d0, &
0.031695087811525991431d0, &
-0.00054213233180001068935d0, &
-0.0033824159510050025955d0 /)
  real(kind=8) :: so1
  real(kind=8) :: so2
  real(kind=8) :: so3
  real(kind=8) :: so4
  real(kind=8) :: so5
  real(kind=8) :: so6
  real(kind=8) :: so7
  real(kind=8) :: so8
  real(kind=8) :: se1
  real(kind=8) :: se2
  real(kind=8) :: se3
  real(kind=8) :: se4
  real(kind=8) :: se5
  real(kind=8) :: se6
  real(kind=8) :: se7
  real(kind=8) :: se8
!$omp parallel default (private) shared(x,y,fil,ndat,n)
!$omp do
  do j=1, ndat - 7, 8
    so1 = 0.0
    so2 = 0.0
    so3 = 0.0
    so4 = 0.0
    so5 = 0.0
    so6 = 0.0
    so7 = 0.0
    so8 = 0.0
    se1 = 0.0
    se2 = 0.0
    se3 = 0.0
    se4 = 0.0
    se5 = 0.0
    se6 = 0.0
    se7 = 0.0
    se8 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((-3) * (2))) * (x(k, j + 7)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((-3) * (2) + 1)) * (x(k, j + 7)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((-2) * (2))) * (x(k, j + 7)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((-2) * (2) + 1)) * (x(k, j + 7)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((-1) * (2))) * (x(k, j + 7)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((-1) * (2) + 1)) * (x(k, j + 7)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((0) * (2))) * (x(k, j + 7)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((0) * (2) + 1)) * (x(k, j + 7)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((1) * (2))) * (x(k, j + 7)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((1) * (2) + 1)) * (x(k, j + 7)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((2) * (2))) * (x(k, j + 7)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((2) * (2) + 1)) * (x(k, j + 7)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((3) * (2))) * (x(k, j + 7)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((3) * (2) + 1)) * (x(k, j + 7)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 7))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
    so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
    se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
    so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
    se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
    so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
    se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
    so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
    se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
    so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
    se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
    so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
    se8 = se8 + (fil((4) * (2))) * (x(k, j + 7)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 7))
    so8 = so8 + (fil((4) * (2) + 1)) * (x(k, j + 7)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 7))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 1, (n) * (2) - 1) = so2
    y(j + 2, (n) * (2) - 1) = so3
    y(j + 3, (n) * (2) - 1) = so4
    y(j + 4, (n) * (2) - 1) = so5
    y(j + 5, (n) * (2) - 1) = so6
    y(j + 6, (n) * (2) - 1) = so7
    y(j + 7, (n) * (2) - 1) = so8
    y(j + 0, 0) = se1
    y(j + 1, 0) = se2
    y(j + 2, 0) = se3
    y(j + 3, 0) = se4
    y(j + 4, 0) = se5
    y(j + 5, 0) = se6
    y(j + 6, 0) = se7
    y(j + 7, 0) = se8
    do i=0,  - -3 - 1
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-3) * (2))) * (x(k, j + 7)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-3) * (2) + 1)) * (x(k, j + 7)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-2) * (2))) * (x(k, j + 7)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-2) * (2) + 1)) * (x(k, j + 7)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-1) * (2))) * (x(k, j + 7)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-1) * (2) + 1)) * (x(k, j + 7)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((0) * (2))) * (x(k, j + 7)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((0) * (2) + 1)) * (x(k, j + 7)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((1) * (2))) * (x(k, j + 7)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((1) * (2) + 1)) * (x(k, j + 7)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((2) * (2))) * (x(k, j + 7)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((2) * (2) + 1)) * (x(k, j + 7)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((3) * (2))) * (x(k, j + 7)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((3) * (2) + 1)) * (x(k, j + 7)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((4) * (2))) * (x(k, j + 7)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((4) * (2) + 1)) * (x(k, j + 7)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 7))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
    do i= - -3, n - 1 - 4
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      k = i + -3
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-3) * (2))) * (x(k, j + 7)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-3) * (2) + 1)) * (x(k, j + 7)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + -2
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-2) * (2))) * (x(k, j + 7)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-2) * (2) + 1)) * (x(k, j + 7)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + -1
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-1) * (2))) * (x(k, j + 7)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-1) * (2) + 1)) * (x(k, j + 7)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 0
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((0) * (2))) * (x(k, j + 7)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((0) * (2) + 1)) * (x(k, j + 7)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 1
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((1) * (2))) * (x(k, j + 7)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((1) * (2) + 1)) * (x(k, j + 7)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 2
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((2) * (2))) * (x(k, j + 7)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((2) * (2) + 1)) * (x(k, j + 7)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 3
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((3) * (2))) * (x(k, j + 7)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((3) * (2) + 1)) * (x(k, j + 7)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 7))
      k = i + 4
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((4) * (2))) * (x(k, j + 7)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((4) * (2) + 1)) * (x(k, j + 7)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 7))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
    do i=n - 4, n - 2
      so1 = 0.0
      so2 = 0.0
      so3 = 0.0
      so4 = 0.0
      so5 = 0.0
      so6 = 0.0
      so7 = 0.0
      so8 = 0.0
      se1 = 0.0
      se2 = 0.0
      se3 = 0.0
      se4 = 0.0
      se5 = 0.0
      se6 = 0.0
      se7 = 0.0
      se8 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-3) * (2))) * (x(k, j + 1)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-3) * (2) + 1)) * (x(k, j + 1)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-3) * (2))) * (x(k, j + 2)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-3) * (2) + 1)) * (x(k, j + 2)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-3) * (2))) * (x(k, j + 3)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-3) * (2) + 1)) * (x(k, j + 3)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-3) * (2))) * (x(k, j + 4)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-3) * (2) + 1)) * (x(k, j + 4)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-3) * (2))) * (x(k, j + 5)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-3) * (2) + 1)) * (x(k, j + 5)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-3) * (2))) * (x(k, j + 6)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-3) * (2) + 1)) * (x(k, j + 6)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-3) * (2))) * (x(k, j + 7)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-3) * (2) + 1)) * (x(k, j + 7)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-2) * (2))) * (x(k, j + 1)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-2) * (2) + 1)) * (x(k, j + 1)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-2) * (2))) * (x(k, j + 2)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-2) * (2) + 1)) * (x(k, j + 2)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-2) * (2))) * (x(k, j + 3)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-2) * (2) + 1)) * (x(k, j + 3)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-2) * (2))) * (x(k, j + 4)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-2) * (2) + 1)) * (x(k, j + 4)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-2) * (2))) * (x(k, j + 5)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-2) * (2) + 1)) * (x(k, j + 5)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-2) * (2))) * (x(k, j + 6)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-2) * (2) + 1)) * (x(k, j + 6)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-2) * (2))) * (x(k, j + 7)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-2) * (2) + 1)) * (x(k, j + 7)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((-1) * (2))) * (x(k, j + 1)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((-1) * (2) + 1)) * (x(k, j + 1)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((-1) * (2))) * (x(k, j + 2)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((-1) * (2) + 1)) * (x(k, j + 2)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((-1) * (2))) * (x(k, j + 3)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((-1) * (2) + 1)) * (x(k, j + 3)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((-1) * (2))) * (x(k, j + 4)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((-1) * (2) + 1)) * (x(k, j + 4)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((-1) * (2))) * (x(k, j + 5)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((-1) * (2) + 1)) * (x(k, j + 5)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((-1) * (2))) * (x(k, j + 6)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((-1) * (2) + 1)) * (x(k, j + 6)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((-1) * (2))) * (x(k, j + 7)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((-1) * (2) + 1)) * (x(k, j + 7)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((0) * (2))) * (x(k, j + 1)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((0) * (2) + 1)) * (x(k, j + 1)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((0) * (2))) * (x(k, j + 2)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((0) * (2) + 1)) * (x(k, j + 2)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((0) * (2))) * (x(k, j + 3)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((0) * (2) + 1)) * (x(k, j + 3)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((0) * (2))) * (x(k, j + 4)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((0) * (2) + 1)) * (x(k, j + 4)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((0) * (2))) * (x(k, j + 5)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((0) * (2) + 1)) * (x(k, j + 5)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((0) * (2))) * (x(k, j + 6)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((0) * (2) + 1)) * (x(k, j + 6)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((0) * (2))) * (x(k, j + 7)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((0) * (2) + 1)) * (x(k, j + 7)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((1) * (2))) * (x(k, j + 1)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((1) * (2) + 1)) * (x(k, j + 1)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((1) * (2))) * (x(k, j + 2)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((1) * (2) + 1)) * (x(k, j + 2)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((1) * (2))) * (x(k, j + 3)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((1) * (2) + 1)) * (x(k, j + 3)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((1) * (2))) * (x(k, j + 4)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((1) * (2) + 1)) * (x(k, j + 4)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((1) * (2))) * (x(k, j + 5)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((1) * (2) + 1)) * (x(k, j + 5)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((1) * (2))) * (x(k, j + 6)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((1) * (2) + 1)) * (x(k, j + 6)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((1) * (2))) * (x(k, j + 7)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((1) * (2) + 1)) * (x(k, j + 7)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((2) * (2))) * (x(k, j + 1)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((2) * (2) + 1)) * (x(k, j + 1)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((2) * (2))) * (x(k, j + 2)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((2) * (2) + 1)) * (x(k, j + 2)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((2) * (2))) * (x(k, j + 3)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((2) * (2) + 1)) * (x(k, j + 3)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((2) * (2))) * (x(k, j + 4)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((2) * (2) + 1)) * (x(k, j + 4)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((2) * (2))) * (x(k, j + 5)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((2) * (2) + 1)) * (x(k, j + 5)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((2) * (2))) * (x(k, j + 6)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((2) * (2) + 1)) * (x(k, j + 6)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((2) * (2))) * (x(k, j + 7)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((2) * (2) + 1)) * (x(k, j + 7)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((3) * (2))) * (x(k, j + 1)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((3) * (2) + 1)) * (x(k, j + 1)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((3) * (2))) * (x(k, j + 2)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((3) * (2) + 1)) * (x(k, j + 2)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((3) * (2))) * (x(k, j + 3)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((3) * (2) + 1)) * (x(k, j + 3)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((3) * (2))) * (x(k, j + 4)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((3) * (2) + 1)) * (x(k, j + 4)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((3) * (2))) * (x(k, j + 5)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((3) * (2) + 1)) * (x(k, j + 5)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((3) * (2))) * (x(k, j + 6)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((3) * (2) + 1)) * (x(k, j + 6)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((3) * (2))) * (x(k, j + 7)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((3) * (2) + 1)) * (x(k, j + 7)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 7))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      se2 = se2 + (fil((4) * (2))) * (x(k, j + 1)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 1))
      so2 = so2 + (fil((4) * (2) + 1)) * (x(k, j + 1)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 1))
      se3 = se3 + (fil((4) * (2))) * (x(k, j + 2)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 2))
      so3 = so3 + (fil((4) * (2) + 1)) * (x(k, j + 2)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 2))
      se4 = se4 + (fil((4) * (2))) * (x(k, j + 3)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 3))
      so4 = so4 + (fil((4) * (2) + 1)) * (x(k, j + 3)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 3))
      se5 = se5 + (fil((4) * (2))) * (x(k, j + 4)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 4))
      so5 = so5 + (fil((4) * (2) + 1)) * (x(k, j + 4)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 4))
      se6 = se6 + (fil((4) * (2))) * (x(k, j + 5)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 5))
      so6 = so6 + (fil((4) * (2) + 1)) * (x(k, j + 5)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 5))
      se7 = se7 + (fil((4) * (2))) * (x(k, j + 6)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 6))
      so7 = so7 + (fil((4) * (2) + 1)) * (x(k, j + 6)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 6))
      se8 = se8 + (fil((4) * (2))) * (x(k, j + 7)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 7))
      so8 = so8 + (fil((4) * (2) + 1)) * (x(k, j + 7)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 7))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 1, (i) * (2) + 1) = so2
      y(j + 2, (i) * (2) + 1) = so3
      y(j + 3, (i) * (2) + 1) = so4
      y(j + 4, (i) * (2) + 1) = so5
      y(j + 5, (i) * (2) + 1) = so6
      y(j + 6, (i) * (2) + 1) = so7
      y(j + 7, (i) * (2) + 1) = so8
      y(j + 0, (i) * (2) + 2) = se1
      y(j + 1, (i) * (2) + 2) = se2
      y(j + 2, (i) * (2) + 2) = se3
      y(j + 3, (i) * (2) + 2) = se4
      y(j + 4, (i) * (2) + 2) = se5
      y(j + 5, (i) * (2) + 2) = se6
      y(j + 6, (i) * (2) + 2) = se7
      y(j + 7, (i) * (2) + 2) = se8
    enddo
  enddo
!$omp end do
!$omp do
  do j=ndat - modulo(ndat, 8) + 1, ndat
    so1 = 0.0
    se1 = 0.0
    i = n - 1
    k = modulo(i + -3, n)
    se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -2, n)
    se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + -1, n)
    se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 0, n)
    se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 1, n)
    se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 2, n)
    se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 3, n)
    se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
    k = modulo(i + 4, n)
    se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
    so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
    y(j + 0, (n) * (2) - 1) = so1
    y(j + 0, 0) = se1
    do i=0, n - 2
      so1 = 0.0
      se1 = 0.0
      k = modulo(i + -3, n)
      se1 = se1 + (fil((-3) * (2))) * (x(k, j + 0)) + (fil((-3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-3) * (2) + 1)) * (x(k, j + 0)) - (fil((-3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -2, n)
      se1 = se1 + (fil((-2) * (2))) * (x(k, j + 0)) + (fil((-2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-2) * (2) + 1)) * (x(k, j + 0)) - (fil((-2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + -1, n)
      se1 = se1 + (fil((-1) * (2))) * (x(k, j + 0)) + (fil((-1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((-1) * (2) + 1)) * (x(k, j + 0)) - (fil((-1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 0, n)
      se1 = se1 + (fil((0) * (2))) * (x(k, j + 0)) + (fil((0) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((0) * (2) + 1)) * (x(k, j + 0)) - (fil((0) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 1, n)
      se1 = se1 + (fil((1) * (2))) * (x(k, j + 0)) + (fil((1) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((1) * (2) + 1)) * (x(k, j + 0)) - (fil((1) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 2, n)
      se1 = se1 + (fil((2) * (2))) * (x(k, j + 0)) + (fil((2) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((2) * (2) + 1)) * (x(k, j + 0)) - (fil((2) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 3, n)
      se1 = se1 + (fil((3) * (2))) * (x(k, j + 0)) + (fil((3) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((3) * (2) + 1)) * (x(k, j + 0)) - (fil((3) * (-2) + 2)) * (x(n + k, j + 0))
      k = modulo(i + 4, n)
      se1 = se1 + (fil((4) * (2))) * (x(k, j + 0)) + (fil((4) * (-2) + 3)) * (x(n + k, j + 0))
      so1 = so1 + (fil((4) * (2) + 1)) * (x(k, j + 0)) - (fil((4) * (-2) + 2)) * (x(n + k, j + 0))
      y(j + 0, (i) * (2) + 1) = so1
      y(j + 0, (i) * (2) + 2) = se1
    enddo
  enddo
!$omp end do
!$omp end parallel
END SUBROUTINE synthesis_per_u8
